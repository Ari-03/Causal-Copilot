<h1 align="center">
<img src="asset/logo.png" width="200" alt="Causality" />
<br>
Causal-Copilot: Towards Autonomous Causal Analysis Agent
</h1>
<p align="center">
  <a href="https://921b68852c4d574f0e.gradio.live/"><b>[Demo]</b></a> â€¢
  <a href="https://github.com/Lancelot39/Causal-Copilot"><b>[Code]</b></a>
</p>


---

## Introduction

Causal-Copilot is a LLM-oriented toolkit for **automatic causal analysis**, aiming to help researchers and data scientists identify, analyze, and understand causal relationships within real-world datasets. Given the data, Causal-Copilot autonomously selects the best-suited causal analysis algorithm, sets up proper hyper-parameters, synthesizes the code for execution, and finally generates the easy-to-read PDF report to users.

---

## Demo

Demo Video (TODO)

Here are some analysis reports for open-source datasets generated by Causal-Copilot

- 1.[Bioinformatics-Abalone](asset/report_Abalone.pdf)
- 2.[Architecture-CCS](asset/report_CCS.pdf)
- 3.[Bioinformatics-Sachs](asset/report_Sachs.pdf)

Just try the online Causal-Copilot in [This Link](https://921b68852c4d574f0e.gradio.live/)

---

## Table of Contents

- [Demo](#Demo)
- [Features](#features)
- [Getting Started](#getting-started)
- [Usage](#usage)
- [License](#license)
- [Contact](#Contact)

---

## Features

- **Automated Causal Analysis**: Carefully designed prompts guide LLMs to select best-suited causal analysis algorithms and identify causal relationships, without the requirements in expertise about causality and extensive parameter tuning.
- **User-friendly Visualization**: Clearly visualize data statistics information, causal graphs and dependency probabilities between variables via easy-to-read figures.
- **Detailed Analysis Report**: Provide well-formulated PDF report for the whole causal analysis process, containing detailed explanation for every step.
- **Extensibility**: Leave interfaces for integrating new causal analysis algorithms and other causality-related libraries.

### Architecture Details

- Our Causal-Copilot consists of three components, namely preprocessing, decision making and visualization parts, which are all supported by SOTA LLMs (e.g., GPT-4o).

<h1 align="center">
<div style="text-align: center;">
    <img src="asset/architecture.png" width="700" alt="Causality" />
</div>
</h1>

### Evaluation on Simulated Data

- We evaluate the automatic causal discovery ability of our Causal-Copilot on simulated data, by comparing its performance with a robust baseline using the defaulted settings of PC algorithm.
- The results show that our Causal-Copilot can achieve much better performance, indicating the effectiveness of its automatic algorithm selection and hyper-parameter setting strategy.

| Metric    | Baseline | Causal-Copilot |
|-----------|----------|-------------------|
| Precision | 78.6%    | **81.6%**         |
| Recall    | 78.2%    | **81.0%**         |
| F1-score  | 76.1%    | **79.3%**         |

---

## Getting Started

### Online Demo

- Welcome to use the online Causal-Copilot via [This Link](https://921b68852c4d574f0e.gradio.live/)


### Local Deployment

- **Python 3.8+**
- Required Python libraries (specified in `requirements.txt`)

Ensure you have the necessary dependencies installed by running:

```bash
pip install -r requirements.txt
```

---

## Usage

```bash
python main.py --data_file your_data --apikey your_openai_apikey --initial_query your_user_query
```

## License

Distributed under the MIT License. See `LICENSE` for more information.

---

## Contributor

- [Xinyue Wang*](https://github.com/CharonWangg), [Kun Zhou*](https://github.com/Lancelot39)(Equal Contribution), [Wenyi Wu](https://github.com/WenyiWU0111), [Fang Nan](https://github.com/Fangn06), Shivam Singh, [Biwei Huang](https://biweihuang.com/)

## Contact

For additional information, questions, or feedback, please contact ours at **xiw159@ucsd.edu**, **franciskunzhou@gmail.com**, **wew058@ucsd.edu**, fnan@ucsd.edu and bih007@ucsd.edu. We welcome contributions! Come and join us now!

